
#define SCROLLTEXT_C
#include "scrolltext.h"
#include "pixel.h"

extern void wait(int);


charmap pix_L = {4,{0x00,0x08,0x08,0x08,0x08,0x08,0x08,0x0F}};
charmap pix_A = {5,{0x00,0x0E,0x11,0x11,0x11,0x1F,0x11,0x11}};
charmap pix_B = {4,{0x00,0x0E,0x09,0x09,0x0E,0x09,0x09,0x0E}};
charmap pix_O = {5,{0x00,0x0E,0x11,0x11,0x11,0x11,0x11,0x0E}};
charmap pix_R = {5,{0x00,0x1C,0x12,0x12,0x1C,0x14,0x12,0x11}};
charmap pix_G = {5,{0x00,0x0E,0x11,0x10,0x17,0x11,0x11,0x0E}};

charmap pix_W = {7,{0x00,0x41,0x41,0x49,0x49,0x55,0x22,0x22}};
/*
charmap pix_G = {5,{0x00,0x0E,0x11,0x10,0x17,0x11,0x11,0x0E}};
charmap pix_G = {5,{0x00,0x0E,0x11,0x10,0x17,0x11,0x11,0x0E}};
charmap pix_G = {5,{0x00,0x0E,0x11,0x10,0x17,0x11,0x11,0x0E}};
charmap pix_G = {5,{0x00,0x0E,0x11,0x10,0x17,0x11,0x11,0x0E}};
charmap pix_G = {5,{0x00,0x0E,0x11,0x10,0x17,0x11,0x11,0x0E}};
charmap pix_G = {5,{0x00,0x0E,0x11,0x10,0x17,0x11,0x11,0x0E}};
charmap pix_G = {5,{0x00,0x0E,0x11,0x10,0x17,0x11,0x11,0x0E}};
charmap pix_G = {5,{0x00,0x0E,0x11,0x10,0x17,0x11,0x11,0x0E}};
charmap pix_G = {5,{0x00,0x0E,0x11,0x10,0x17,0x11,0x11,0x0E}};
*/


void shift_in(charmap * cm, unsigned int delay){
	unsigned char plane, col;
	unsigned char i, j;	
	for(i=0;i<cm->len;i++){
		for(j=0;j<8;j++){
			col = (pixmap[0][j]>>1)|(  ( 0x01 & (cm->pix[j]>>(cm->len-i-1)) )  ?  0x80:0   );
			for(plane=0; plane < NUMPLANE; plane++)
				pixmap[plane][j] = col;
		}
		wait(delay);
	}
	
	for(i=0;i<2;i++){
		for(j=0;j<8;j++){
			col = (pixmap[0][j]>>1);
			for(plane=0; plane < NUMPLANE; plane++)
				pixmap[plane][j] = col;
		}
		wait(delay);
	}
}


void shift_out(unsigned char cols, unsigned int delay){
	unsigned char i, j;
	unsigned char plane, col;
	for(i=0;i<cols;i++){
		for(j=0;j<8;j++){
			col =(pixmap[0][j]>>1);
			for(plane=0; plane < NUMPLANE; plane++)
				pixmap[plane][j] = col;
		}
		wait(delay);
	}
}
